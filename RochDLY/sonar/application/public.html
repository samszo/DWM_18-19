<!DOCTYPE html>
<html lang="fr-FR">
    <head>
        <meta charset="UTF-8" />
        <link rel="stylesheet" type="text/css" href="styles/main.css" />
        <script type="text/js" src="scripts/main.js"></script>
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    </head>
    <body>
    <header>
        <div class="searchBar">

            <form action="/search" id="searchthis" method="get">
            <input id="search" name="search" type="text" placeholder="Rechercher" />
            <input id="search-btn" type="submit" value="Rechercher" />
            </form>
                                        
        </div>
    </header>

        <div class="force">
            <div id="orbit">
            <svg width="960" height="800" viewBox="-480 -250 960 500">
                <circle r="100" stroke="#00F7A1" stroke-opacity="0.5" fill="none"></circle>
                <circle r="200" stroke="#00F7A1" stroke-opacity="0.5" fill="none"></circle>
                <circle r="300" stroke="#00F7A1" stroke-opacity="0.5" fill="none"></circle>
              </svg>
              </div>
        </div>

        <div class="titreArchive"></div>

    <footer>
        <div class="navButton">
            <img src="images/bouton1.png" />
            <img src="images/bouton2.png" />
            <img src="images/bouton3.png" />
        </div>
    </footer>

<script src="https://d3js.org/d3-array.v1.min.js"></script>
<script src="https://d3js.org/d3-collection.v1.min.js"></script>
<script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
<script src="https://d3js.org/d3-quadtree.v1.min.js"></script>
<script src="https://d3js.org/d3-selection.v1.min.js"></script>
<script src="https://d3js.org/d3-timer.v1.min.js"></script>
<script src="https://d3js.org/d3-force.v1.min.js"></script>
<script src="https://d3js.org/d3-dsv.v1.min.js"></script>
<script src="https://d3js.org/d3-fetch.v1.min.js"></script>

<script>

// Données JSON Deleuze
// var urlDeleuze = "http://www.http://jardindesconnaissances.univ-paris8.fr/public/deleuze/cherche?term=libert%C3%A9";
var urlDeleuze = "http://localhost/DWM_18-19/RochDLY/sonar/application/data/data.json";
var dataDeleuze;

// Merci à Samszo pour ses corrections !
d3.json(urlDeleuze)
  .then(function(data){
    // Code from your callback goes here...
    dataDeleuze = data;
    // console.log(dataDeleuze);
 
    /* Merci à Mike Bostock pour son algorithmme Radial Force : 
    https://bl.ocks.org/mbostock/cd98bf52e9067e26945edd95e8cf6ef9

    // Code Radial Force D3js    
    var nodes = [].concat(
    d3.range(80).map(function() { return {type: "a"}; }),
    d3.range(160).map(function() { return {type: "b"}; })
    );

    var node = d3.select("svg")
    .append("g")
    .selectAll("circle")
    .data(nodes)
    .enter().append("circle")
        .attr("r", 2.5)
        .attr("fill", function(d) { return d.type === "a" ? "#04f5b5" : "#04f5b5"; })

    var simulation = d3.forceSimulation(nodes)
        .force("charge", d3.forceCollide().radius(5))
        .force("r", d3.forceRadial(function(d) { return d.type === "a" ? 100 : 200; }))
        .on("tick", ticked);

    function ticked() {
    node
        .attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; });
    }
    */

    // Code expérimental Roch

for (i in dataDeleuze) {
    
}



    var nodes = [].concat(
    d3.range(80).map(function() { 
        if (dataDeleuze.score > 0.3)
            return {type: "a"}; }),
    d3.range(160).map(function() { 
        if (dataDeleuze.score >= 0.2)
            return {type: "b"}; }),
    d3.range(240).map(function() { 
        if (dataDeleuze.score < 0.2)
            return {type: "c"}; })
    );

    var node = d3.select("svg")
    .append("g")
    .selectAll("circle")
    .data(nodes)
    .enter().append("circle")
        .attr("r", 2.5)
        .attr("fill", "#04f5b5");

    var simulation = d3.forceSimulation(nodes)
        .force("charge", d3.forceCollide().radius(5))
        .force("r", d3.forceRadial(function(d) { 
            if (d.type === "a") 
            {
                return  100;
            }
            else if (d.type === "b") 
            {
                return 200;
            }
            else 
            {
                return 300;
            }
        }))
        .on("tick", ticked);

    function ticked() {
    node
        .attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; });
    }

});  




</script>

    </body>
</html>